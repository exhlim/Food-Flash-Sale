{"ast":null,"code":"var _jsxFileName = \"/Users/aurelialim/wdi/SEI-24-Project-3/client/src/Components/User/OrderHistory/OrderDetails/RatingStarsContainer.js\";\nimport React, { Component } from \"react\";\nimport RatingStars from \"./RatingStars\";\n\nclass RatingStarsContainer extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      display: true,\n      html: \"\",\n      receipt_id: props.receipt_id,\n      user_id: props.user_id,\n      displayStar: true,\n      merchant_id: props.merchant_id,\n      submitted: false,\n      rating: 0\n    };\n    this.decide = this.decide.bind(this);\n    this.onSubmitHandler = this.onSubmitHandler.bind(this);\n  }\n\n  onSubmitHandler(e) {\n    console.log(\"clicked star\");\n    e.preventDefault();\n    this.setState({\n      submitted: true,\n      rating: e.target.value\n    });\n  }\n\n  componentDidMount() {\n    if (this.state.display) {\n      fetch(`/getratingsuser/${this.state.user_id}/${this.state.receipt_id}`).then(res => res.json()).then(res => this.setState({\n        displayStar: this.decide(res),\n        submitted: !this.decide(res)\n      }));\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    console.log(\"outside the conditional\");\n\n    if (prevState.submitted !== this.state.submitted) {\n      console.log(\"inside conditional\");\n      fetch(\"/ratelisting\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          rating_receipt_id: this.state.receipt_id,\n          listing_id: this.state.listing_id,\n          merchant_id: this.state.merchant_id,\n          rating_stars: this.state.rating\n        })\n      }).then(res => res.json()).then(res => {\n        this.setState({\n          displayStar: false,\n          rated: true\n        });\n      });\n    }\n  } //helper function\n\n\n  decide(array) {\n    let displayStar;\n\n    if (array[0].rating_stars === null) {\n      displayStar = true;\n    } else {\n      displayStar = false;\n    }\n\n    return displayStar;\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(RatingStars, {\n      displayStar: this.state.displayStar,\n      receipt_id: this.state.receipt_id,\n      user_id: this.state.user_id,\n      listing_id: this.props.listing_id,\n      merchant_id: this.state.merchant_id,\n      onClick: this.onSubmitHandler,\n      submitted: this.state.submitted,\n      rating: this.state.rating,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nexport default RatingStarsContainer;","map":{"version":3,"sources":["/Users/aurelialim/wdi/SEI-24-Project-3/client/src/Components/User/OrderHistory/OrderDetails/RatingStarsContainer.js"],"names":["React","Component","RatingStars","RatingStarsContainer","constructor","props","state","display","html","receipt_id","user_id","displayStar","merchant_id","submitted","rating","decide","bind","onSubmitHandler","e","console","log","preventDefault","setState","target","value","componentDidMount","fetch","then","res","json","componentDidUpdate","prevProps","prevState","method","headers","body","JSON","stringify","rating_receipt_id","listing_id","rating_stars","rated","array","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport RatingStars from \"./RatingStars\";\n\nclass RatingStarsContainer extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      display: true,\n      html: \"\",\n      receipt_id: props.receipt_id,\n      user_id: props.user_id,\n      displayStar: true,\n      merchant_id: props.merchant_id,\n      submitted: false,\n      rating: 0,\n    };\n    this.decide = this.decide.bind(this);\n    this.onSubmitHandler = this.onSubmitHandler.bind(this);\n  }\n\n  onSubmitHandler(e) {\n    console.log(\"clicked star\");\n    e.preventDefault();\n    this.setState({ submitted: true, rating: e.target.value });\n  }\n  componentDidMount() {\n    if (this.state.display) {\n      fetch(`/getratingsuser/${this.state.user_id}/${this.state.receipt_id}`)\n        .then((res) => res.json())\n        .then((res) =>\n          this.setState({\n            displayStar: this.decide(res),\n            submitted: !this.decide(res),\n          })\n        );\n    }\n  }\n  componentDidUpdate(prevProps, prevState) {\n    console.log(\"outside the conditional\");\n    if (prevState.submitted !== this.state.submitted) {\n      console.log(\"inside conditional\");\n      fetch(\"/ratelisting\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          rating_receipt_id: this.state.receipt_id,\n          listing_id: this.state.listing_id,\n          merchant_id: this.state.merchant_id,\n          rating_stars: this.state.rating,\n        }),\n      })\n        .then((res) => res.json())\n        .then((res) => {\n          this.setState({\n            displayStar: false,\n            rated: true,\n          });\n        });\n    }\n  }\n\n  //helper function\n  decide(array) {\n    let displayStar;\n    if (array[0].rating_stars === null) {\n      displayStar = true;\n    } else {\n      displayStar = false;\n    }\n    return displayStar;\n  }\n  render() {\n    return (\n      <div>\n        <RatingStars\n          displayStar={this.state.displayStar}\n          receipt_id={this.state.receipt_id}\n          user_id={this.state.user_id}\n          listing_id={this.props.listing_id}\n          merchant_id={this.state.merchant_id}\n          onClick={this.onSubmitHandler}\n          submitted={this.state.submitted}\n          rating={this.state.rating}\n        />\n      </div>\n    );\n  }\n}\n\nexport default RatingStarsContainer;\n"]},"metadata":{},"sourceType":"module"}