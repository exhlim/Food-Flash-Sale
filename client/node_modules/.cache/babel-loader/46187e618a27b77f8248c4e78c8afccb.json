{"ast":null,"code":"var _jsxFileName = \"/home/rlyz/wdi/sei-24-project-3/client/src/Components/User/TimeLine/EachMerchant/EachMerchant.js\";\nimport React, { useEffect, useState } from 'react';\nexport default function EachMerchant(props) {\n  // console.log(props.duration);\n  // console.log(props.time);\n  // console.log(+props.duration - Math.floor((new Date(props.time) / 1000 / 60) % 60))\n  var difference;\n\n  const calculateTimeLeft = () => {\n    const uploadTime = new Date(props.time);\n    uploadTime.setMinutes(uploadTime.getMinutes() + props.duration);\n    difference = +uploadTime - +new Date();\n    let timeLeft = {};\n\n    if (difference > 0) {\n      timeLeft = {\n        hours: Math.floor(difference / (1000 * 60 * 60) % 24),\n        minutes: Math.floor(difference / 1000 / 60 % 60),\n        seconds: Math.floor(difference / 1000 % 60)\n      };\n      return timeLeft;\n    } else if (difference < 0) {\n      timeLeft = 0;\n      fetch('/togglelisting', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          listing_id: props.listing_id,\n          boolean: false\n        })\n      }).then(res => res.text()).then(res => {\n        console.log(res);\n        this.setState({\n          fetch: !this.state.fetch\n        });\n      }); // console.log(timeLeft)\n\n      return timeLeft;\n    }\n  };\n\n  const [mount, setMount] = useState('True'); // useEffect(() => {\n  //     return () => {\n  //         console.log('this is in mount useeffect')\n  //         props.unmount()\n  //     }\n  // }, [mount])\n\n  const [timeLeft, setTimeLeft] = useState(calculateTimeLeft()); // if (timeLeft) {\n  //     if (timeLeft.hours === 0 && timeLeft.minutes === 0 && timeLeft.seconds === 0) {\n  //         console.log(\"help in mount\")\n  //         setMount(!mount)\n  //     }\n  // }\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      setTimeLeft(calculateTimeLeft());\n    }, 1000);\n    return () => {\n      props.what(timeLeft, props.merchant_Id);\n      clearTimeout(timer);\n    };\n  });\n  const timerComponents = [];\n  Object.keys(timeLeft).forEach(interval => {\n    if (!timeLeft[interval]) {\n      return;\n    }\n\n    timerComponents.push( /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 13\n      }\n    }, timeLeft[interval], \" \", interval, \" \"));\n  }); // if (timeLeft.hours == 0 && timeLeft.minutes == 0 && timeLeft.seconds == 0) {\n  //     return null\n  // } else {\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, timerComponents.length ? /*#__PURE__*/React.createElement(\"div\", {\n    key: props.index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 42\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 21\n    }\n  }, props.children), \" \", timerComponents) : null);\n}","map":{"version":3,"sources":["/home/rlyz/wdi/sei-24-project-3/client/src/Components/User/TimeLine/EachMerchant/EachMerchant.js"],"names":["React","useEffect","useState","EachMerchant","props","difference","calculateTimeLeft","uploadTime","Date","time","setMinutes","getMinutes","duration","timeLeft","hours","Math","floor","minutes","seconds","fetch","method","headers","body","JSON","stringify","listing_id","boolean","then","res","text","console","log","setState","state","mount","setMount","setTimeLeft","timer","setTimeout","what","merchant_Id","clearTimeout","timerComponents","Object","keys","forEach","interval","push","length","index","children"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AAEA,eAAe,SAASC,YAAT,CAAsBC,KAAtB,EAA6B;AAExC;AACA;AACA;AACA,MAAIC,UAAJ;;AACA,QAAMC,iBAAiB,GAAG,MAAM;AAE5B,UAAMC,UAAU,GAAG,IAAIC,IAAJ,CAASJ,KAAK,CAACK,IAAf,CAAnB;AACAF,IAAAA,UAAU,CAACG,UAAX,CAAsBH,UAAU,CAACI,UAAX,KAA0BP,KAAK,CAACQ,QAAtD;AACAP,IAAAA,UAAU,GAAG,CAACE,UAAD,GAAc,CAAC,IAAIC,IAAJ,EAA5B;AAEA,QAAIK,QAAQ,GAAG,EAAf;;AACA,QAAIR,UAAU,GAAG,CAAjB,EAAoB;AAChBQ,MAAAA,QAAQ,GAAG;AACPC,QAAAA,KAAK,EAAEC,IAAI,CAACC,KAAL,CAAYX,UAAU,IAAI,OAAO,EAAP,GAAY,EAAhB,CAAX,GAAkC,EAA7C,CADA;AAEPY,QAAAA,OAAO,EAAEF,IAAI,CAACC,KAAL,CAAYX,UAAU,GAAG,IAAb,GAAoB,EAArB,GAA2B,EAAtC,CAFF;AAGPa,QAAAA,OAAO,EAAEH,IAAI,CAACC,KAAL,CAAYX,UAAU,GAAG,IAAd,GAAsB,EAAjC;AAHF,OAAX;AAKA,aAAOQ,QAAP;AACH,KAPD,MAOO,IAAIR,UAAU,GAAG,CAAjB,EAAoB;AACvBQ,MAAAA,QAAQ,GAAG,CAAX;AAEAM,MAAAA,KAAK,CAAC,gBAAD,EAAmB;AACpBC,QAAAA,MAAM,EAAE,MADY;AAEpBC,QAAAA,OAAO,EAAE;AACL,0BAAgB;AADX,SAFW;AAKpBC,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AAAEC,UAAAA,UAAU,EAAErB,KAAK,CAACqB,UAApB;AAAgCC,UAAAA,OAAO,EAAE;AAAzC,SAAf;AALc,OAAnB,CAAL,CAOKC,IAPL,CAOWC,GAAD,IAASA,GAAG,CAACC,IAAJ,EAPnB,EAQKF,IARL,CAQWC,GAAD,IAAS;AACXE,QAAAA,OAAO,CAACC,GAAR,CAAYH,GAAZ;AACA,aAAKI,QAAL,CAAc;AACVb,UAAAA,KAAK,EAAE,CAAC,KAAKc,KAAL,CAAWd;AADT,SAAd;AAGH,OAbL,EAHuB,CAiBvB;;AACA,aAAON,QAAP;AACH;AAEJ,GAnCD;;AAqCA,QAAM,CAACqB,KAAD,EAAQC,QAAR,IAAoBjC,QAAQ,CAAC,MAAD,CAAlC,CA3CwC,CA6CxC;AACA;AACA;AACA;AACA;AACA;;AAIA,QAAM,CAACW,QAAD,EAAWuB,WAAX,IAA0BlC,QAAQ,CAACI,iBAAiB,EAAlB,CAAxC,CAtDwC,CAwDxC;AACA;AACA;AACA;AACA;AACA;;AAEAL,EAAAA,SAAS,CAAC,MAAM;AACZ,UAAMoC,KAAK,GAAGC,UAAU,CAAC,MAAM;AAC3BF,MAAAA,WAAW,CAAC9B,iBAAiB,EAAlB,CAAX;AACH,KAFuB,EAErB,IAFqB,CAAxB;AAGA,WAAO,MAAM;AACTF,MAAAA,KAAK,CAACmC,IAAN,CAAW1B,QAAX,EAAqBT,KAAK,CAACoC,WAA3B;AAEAC,MAAAA,YAAY,CAACJ,KAAD,CAAZ;AACH,KAJD;AAKH,GATQ,CAAT;AAWA,QAAMK,eAAe,GAAG,EAAxB;AAGAC,EAAAA,MAAM,CAACC,IAAP,CAAY/B,QAAZ,EAAsBgC,OAAtB,CAA+BC,QAAD,IAAc;AACxC,QAAI,CAACjC,QAAQ,CAACiC,QAAD,CAAb,EAAyB;AACrB;AACH;;AAEDJ,IAAAA,eAAe,CAACK,IAAhB,eACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACKlC,QAAQ,CAACiC,QAAD,CADb,OAC0BA,QAD1B,EACoC,GADpC,CADJ;AAKH,GAVD,EA7EwC,CAyFxC;AAEA;AACA;;AAEA,sBACI,0CAEQJ,eAAe,CAACM,MAAhB,gBAAyB;AAAK,IAAA,GAAG,EAAE5C,KAAK,CAAC6C,KAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAK7C,KAAK,CAAC8C,QAAX,CADqB,OACMR,eADN,CAAzB,GACwD,IAHhE,CADJ;AAQH","sourcesContent":["import React, { useEffect, useState } from 'react'\n\nexport default function EachMerchant(props) {\n\n    // console.log(props.duration);\n    // console.log(props.time);\n    // console.log(+props.duration - Math.floor((new Date(props.time) / 1000 / 60) % 60))\n    var difference;\n    const calculateTimeLeft = () => {\n\n        const uploadTime = new Date(props.time)\n        uploadTime.setMinutes(uploadTime.getMinutes() + props.duration)\n        difference = +uploadTime - +new Date();\n\n        let timeLeft = {};\n        if (difference > 0) {\n            timeLeft = {\n                hours: Math.floor((difference / (1000 * 60 * 60)) % 24),\n                minutes: Math.floor((difference / 1000 / 60) % 60),\n                seconds: Math.floor((difference / 1000) % 60)\n            };\n            return timeLeft\n        } else if (difference < 0) {\n            timeLeft = 0\n\n            fetch('/togglelisting', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({ listing_id: props.listing_id, boolean: false })\n            })\n                .then((res) => res.text())\n                .then((res) => {\n                    console.log(res)\n                    this.setState({\n                        fetch: !this.state.fetch\n                    })\n                })\n            // console.log(timeLeft)\n            return timeLeft\n        }\n\n    };\n\n    const [mount, setMount] = useState('True')\n\n    // useEffect(() => {\n    //     return () => {\n    //         console.log('this is in mount useeffect')\n    //         props.unmount()\n    //     }\n    // }, [mount])\n\n\n\n    const [timeLeft, setTimeLeft] = useState(calculateTimeLeft());\n\n    // if (timeLeft) {\n    //     if (timeLeft.hours === 0 && timeLeft.minutes === 0 && timeLeft.seconds === 0) {\n    //         console.log(\"help in mount\")\n    //         setMount(!mount)\n    //     }\n    // }\n\n    useEffect(() => {\n        const timer = setTimeout(() => {\n            setTimeLeft(calculateTimeLeft());\n        }, 1000);\n        return () => {\n            props.what(timeLeft, props.merchant_Id);\n\n            clearTimeout(timer);\n        }\n    });\n\n    const timerComponents = [];\n\n\n    Object.keys(timeLeft).forEach((interval) => {\n        if (!timeLeft[interval]) {\n            return;\n        }\n\n        timerComponents.push(\n            <span>\n                {timeLeft[interval]} {interval}{\" \"}\n            </span>\n        );\n    });\n\n    // if (timeLeft.hours == 0 && timeLeft.minutes == 0 && timeLeft.seconds == 0) {\n\n    //     return null\n    // } else {\n\n    return (\n        <>\n            {\n                timerComponents.length ? <div key={props.index}>\n                    <h1>{props.children}</h1> {timerComponents}</div> : null\n            }\n        </>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}