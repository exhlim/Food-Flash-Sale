{"ast":null,"code":"var _jsxFileName = \"/Users/aurelialim/wdi/SEI-24-Project-3/client/src/Components/User/IndivStore/ListingContainer.js\";\nimport React from 'react';\nimport IndivListing from './IndivListing';\nimport Basket from './Basket';\nimport PaymentOverlay from './PaymentOverlay';\nexport default class ListingContainer extends React.Component {\n  constructor(props) {\n    //mounting\n    super(props);\n    console.log(\"----inside Listing constructor\");\n    this.state = {\n      merchant_id: props.merchant_id,\n      merchant_name: \"\",\n      merchant_img: \"\",\n      html: [],\n      result: [],\n      cart: [],\n      viewCart: false,\n      checkout: false\n    };\n    this.addToCart = this.addToCart.bind(this);\n    this.navigateTo = this.navigateTo.bind(this);\n    this.handleAddToCart = this.handleAddToCart.bind(this);\n    this.handleRemoveFromCart = this.handleRemoveFromCart.bind(this);\n    this.handleCheckOut = this.handleCheckOut.bind(this);\n  } //\n  //payment click handlling\n\n\n  handleCheckOut() {\n    this.setState({\n      checkout: true\n    });\n  } //delete from cart\n\n\n  handleRemoveFromCart(e, item) {\n    this.setState(state => {\n      const cart = state.cart.filter(element => element.name != item.name);\n      localStorage.setItem('cart', cart);\n      return {\n        cart\n      };\n    });\n  } //add to cart button\n\n\n  addToCart(e, addToCart) {\n    console.log(addToCart);\n    this.setState(prevState => ({\n      cart: [...prevState.cart, addToCart]\n    }));\n  } // view cart button\n\n\n  navigateTo() {\n    this.setState({\n      viewCart: true\n    });\n  }\n\n  handleAddToCart(e, product) {\n    console.log(product);\n    this.setState(state => {\n      const cart = state.cart;\n      let productAlreadyInCart = false;\n      cart.forEach(item => {\n        if (item.name === product.name) {\n          productAlreadyInCart = true;\n          item.count++;\n        }\n      });\n\n      if (!productAlreadyInCart) {\n        cart.push({ ...product,\n          count: 1\n        });\n      }\n\n      localStorage.setItem(\"cart\", JSON.stringify(cart));\n      return cart;\n    });\n  } //when state is changed, FETCH results from aPI\n  //side effects ie: HTTP requests are allowed here\n\n\n  componentDidMount() {\n    fetch(\"/indivshop/1\").then(res => res.json()).then(res => this.setState({\n      result: res,\n      html: this.format(res),\n      merchant_name: res[0].name\n    }));\n  } //update and re-render once checkout is clicked and this.state.checkout=true;\n\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevState.checkout !== this.state.checkout) {\n      return /*#__PURE__*/React.createElement(PaymentOverlay, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 20\n        }\n      });\n    }\n  } //helper functions\n  //take the res.json and convert into nice HTML\n\n\n  format(array) {\n    return array.map((item, index) => {\n      let item_name = item.item_name;\n      let quantity = item.quantity;\n      let discPrice = item.price_ceiling;\n      let originalPrice = item.unit_price;\n      let discount = (originalPrice - discPrice) / originalPrice;\n      let merchant_name = item.name;\n      let cuisine = item.cuisine;\n      let listing_id = item.listing_id;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: index,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 16\n        }\n      }, /*#__PURE__*/React.createElement(IndivListing, {\n        item_name: item_name,\n        quantity: quantity,\n        discPrice: discPrice,\n        originalPrice: originalPrice,\n        discPrice: discPrice,\n        discount: discount,\n        merchant_name: merchant_name,\n        cuisine: cuisine,\n        onClick: this.handleAddToCart,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 9\n        }\n      }));\n    });\n  }\n\n  render() {\n    if (this.state.viewCart) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Basket, {\n        cart: this.state.cart,\n        handleRemoveFromCart: this.handleRemoveFromCart,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        onClick: this.navigateTo,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 13\n        }\n      }, \"View Cart \", this.state.cart.length), /*#__PURE__*/React.createElement(\"button\", {\n        onClick: this.handleCheckOut,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 13\n        }\n      }, \"checkout\"), /*#__PURE__*/React.createElement(\"h1\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 17\n        }\n      }, \"You are viewing deals from \", this.state.merchant_name), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"ListItems\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 17\n        }\n      }, this.state.html));\n    } else {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"button\", {\n        onClick: this.navigateTo,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 13\n        }\n      }, \"View Cart \", this.state.cart.length), /*#__PURE__*/React.createElement(\"h1\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 17\n        }\n      }, \"You are viewing deals from \", this.state.merchant_name), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"ListItems\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 17\n        }\n      }, this.state.html));\n    }\n  }\n\n}","map":{"version":3,"sources":["/Users/aurelialim/wdi/SEI-24-Project-3/client/src/Components/User/IndivStore/ListingContainer.js"],"names":["React","IndivListing","Basket","PaymentOverlay","ListingContainer","Component","constructor","props","console","log","state","merchant_id","merchant_name","merchant_img","html","result","cart","viewCart","checkout","addToCart","bind","navigateTo","handleAddToCart","handleRemoveFromCart","handleCheckOut","setState","e","item","filter","element","name","localStorage","setItem","prevState","product","productAlreadyInCart","forEach","count","push","JSON","stringify","componentDidMount","fetch","then","res","json","format","componentDidUpdate","prevProps","array","map","index","item_name","quantity","discPrice","price_ceiling","originalPrice","unit_price","discount","cuisine","listing_id","render","length"],"mappings":"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","sourcesContent":["import React from 'react';\nimport IndivListing from './IndivListing';\nimport Basket from './Basket';\nimport PaymentOverlay from './PaymentOverlay';\n\n\n\nexport default class ListingContainer extends React.Component {\n    constructor(props){\n        //mounting\n        super(props)\n        console.log(\"----inside Listing constructor\")\n\n        this.state = {\n            merchant_id: props.merchant_id,\n            merchant_name: \"\",\n            merchant_img: \"\",\n            html: [],\n            result: [],\n            cart: [],\n            viewCart: false,\n            checkout: false\n        }\n\n        this.addToCart = this.addToCart.bind(this);\n        this.navigateTo = this.navigateTo.bind(this)\n        this.handleAddToCart = this.handleAddToCart.bind(this)\n        this.handleRemoveFromCart = this.handleRemoveFromCart.bind(this);\n        this.handleCheckOut = this.handleCheckOut.bind(this)\n\n    }\n//\n\n\n\n\n//payment click handlling\nhandleCheckOut(){\n    this.setState({checkout: true})\n\n}\n\n\n\n\n//delete from cart\nhandleRemoveFromCart(e,item){\n    this.setState(state=>{\n        const cart = state.cart.filter(element=> element.name != item.name);\n        localStorage.setItem('cart',cart);\n        return {cart}\n    })\n}\n\n\n//add to cart button\naddToCart(e,addToCart){\n    console.log(addToCart)\n    this.setState((prevState)=>\n        ({cart:[...prevState.cart,addToCart]}))\n}\n\n// view cart button\nnavigateTo(){\n    this.setState({viewCart:true})\n}\n\nhandleAddToCart(e,product){\n    console.log(product)\n\n    this.setState(state=>{\n        const cart = state.cart;\n        let productAlreadyInCart = false;\n        cart.forEach(item =>{\n            if(item.name===product.name){\n                productAlreadyInCart=true;\n                item.count ++;\n            }\n        });\n        if(!productAlreadyInCart){\n            cart.push({...product,count:1})\n        }\n        localStorage.setItem(\"cart\",JSON.stringify(cart));\n        return cart;\n    })\n}\n\n\n//when state is changed, FETCH results from aPI\n//side effects ie: HTTP requests are allowed here\n    componentDidMount() {\n        fetch(\"/indivshop/1\")\n        .then(res => res.json())\n        .then(res =>\n                this.setState({result: res, html:this.format(res),merchant_name: res[0].name})\n        )\n    }\n\n\n//update and re-render once checkout is clicked and this.state.checkout=true;\n\ncomponentDidUpdate (prevProps,prevState) {\n        if(prevState.checkout !== this.state.checkout){\n            return <PaymentOverlay/>\n        }\n    }\n\n\n\n\n//helper functions\n\n//take the res.json and convert into nice HTML\nformat(array) {\n    return array.map((item,index)=>{\n        let item_name = item.item_name;\n        let quantity = item.quantity;\n        let discPrice = item.price_ceiling;\n        let originalPrice =item.unit_price;\n        let discount = (originalPrice-discPrice)/originalPrice\n        let merchant_name = item.name;\n        let cuisine = item.cuisine;\n        let listing_id = item.listing_id;\n\n        return <div key={index}>\n        <IndivListing item_name={item_name} quantity={quantity} discPrice ={discPrice} originalPrice={originalPrice} discPrice={discPrice}discount={discount} merchant_name={merchant_name} cuisine={cuisine}  onClick ={this.handleAddToCart}/>\n\n        </div>\n    })\n}\n\n\n\n\n    render(){\n\n\n\n\n\n\n       if(this.state.viewCart){\n            return (\n            <div>\n            <Basket cart={this.state.cart} handleRemoveFromCart={this.handleRemoveFromCart}/>\n            <button onClick={this.navigateTo}>View Cart {this.state.cart.length}</button>\n            <button onClick={this.handleCheckOut}>checkout</button>\n                <h1>You are viewing deals from {this.state.merchant_name}</h1>\n                <br/>\n\n                <div className=\"ListItems\" >\n                {this.state.html}\n                </div>\n                </div>\n                )\n\n        }else{\n            return (\n            <>\n            <button onClick={this.navigateTo}>View Cart {this.state.cart.length}</button>\n                <h1>You are viewing deals from {this.state.merchant_name}</h1>\n                <br/>\n\n                <div className=\"ListItems\" >\n                {this.state.html}\n                </div>\n\n            </>\n            )\n    }\n}\n}"]},"metadata":{},"sourceType":"module"}