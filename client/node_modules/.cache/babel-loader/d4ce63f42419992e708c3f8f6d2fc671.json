{"ast":null,"code":"var _jsxFileName = \"/home/rlyz/wdi/sei-24-project-3/client/src/Components/User/TimeLine/TimeLine.js\";\nimport React, { Component } from 'react';\nimport EachMerchant from './EachMerchant/EachMerchant';\nimport OrderHistory from '../OrderHistory/OrderHistory';\nimport { Route, Link, Redirect, Switch } from 'react-router-dom';\nimport IndivListing from '../IndivStore/IndivListing';\nimport ListingContainer from '../IndivStore/ListingContainer';\nexport default class TimeLine extends Component {\n  constructor(props) {\n    super();\n\n    this.merchantCardUnmountHandler = () => {\n      console.log('hi function');\n      fetch('/timeline').then(res => res.json()).then(res => {\n        console.log(res);\n        this.setState({\n          timeLine: res\n        });\n      });\n    };\n\n    this.state = {\n      timeLine: [],\n      cardUnmount: false\n    };\n  }\n\n  componentDidMount() {\n    fetch('/timeline').then(res => res.json()).then(res => {\n      console.log(res);\n      this.setState({\n        timeLine: res\n      });\n    });\n  }\n\n  componentDidUpdate(prevProps) {\n    console.log(this.props, this.state);\n    console.log('hi 1');\n\n    if (this.props.userID !== prevProps.userID) {\n      console.log('hi');\n      fetch('/timeline').then(res => res.json()).then(res => {\n        console.log(res);\n        this.setState({\n          timeLine: res\n        });\n      });\n    }\n  }\n\n  render() {\n    if (this.state.timeLine.length > 20) {\n      this.state.timeLine.splice(19, this.state.timeLine.length - 20);\n    }\n\n    this.state.timeLine.sort(function (a, b) {\n      const uploadTimeA = new Date(a.time);\n      uploadTimeA.setMinutes(uploadTimeA.getMinutes() + a.time);\n      const uploadTimeB = new Date(b.time);\n      uploadTimeB.setMinutes(uploadTimeB.getMinutes() + b.time);\n      return uploadTimeA - uploadTimeB;\n    });\n    const merchantCard = this.state.timeLine.map((eachCard, index) => {\n      const discount = (eachCard.unit_price - eachCard.price_floor) / eachCard.unit_price * 100;\n      let path = \"/\" + eachCard.merchant_id;\n      return /*#__PURE__*/React.createElement(Link, {\n        to: path,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 20\n        }\n      }, /*#__PURE__*/React.createElement(EachMerchant, {\n        key: index,\n        duration: eachCard.time_limit_min,\n        time: eachCard.time,\n        merchant_Id: eachCard.merchant_id,\n        unmount: this.merchantCardUnmountHandler,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 21\n        }\n      }, eachCard.name), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 21\n        }\n      }, \"up to\", discount, \"%\")));\n    });\n    const routeArray = this.state.timeLine.map((eachCard, index) => {\n      let path = \"/\" + eachCard.merchant_id;\n      return /*#__PURE__*/React.createElement(Route, {\n        path: path,\n        render: () => /*#__PURE__*/React.createElement(ListingContainer, {\n          merchant_id: eachCard.merchant_id,\n          stripper: this.props.stripper,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 23\n          }\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 20\n        }\n      });\n    });\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"navbar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 21\n      }\n    }, \"Image here\"), /*#__PURE__*/React.createElement(Link, {\n      className: \"login break\",\n      to: \"/Timeline\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 21\n      }\n    }, \"Timeline\"), /*#__PURE__*/React.createElement(Link, {\n      className: \"login break\",\n      to: \"/Orderhistory\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 21\n      }\n    }, \"Order history\")), /*#__PURE__*/React.createElement(\"main\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Switch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 21\n      }\n    }, routeArray, /*#__PURE__*/React.createElement(Route, {\n      path: \"/Orderhistory\",\n      render: () => /*#__PURE__*/React.createElement(OrderHistory, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 35\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      path: \"/\",\n      render: () => /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 35\n        }\n      }, merchantCard),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 25\n      }\n    }))));\n  }\n\n}","map":{"version":3,"sources":["/home/rlyz/wdi/sei-24-project-3/client/src/Components/User/TimeLine/TimeLine.js"],"names":["React","Component","EachMerchant","OrderHistory","Route","Link","Redirect","Switch","IndivListing","ListingContainer","TimeLine","constructor","props","merchantCardUnmountHandler","console","log","fetch","then","res","json","setState","timeLine","state","cardUnmount","componentDidMount","componentDidUpdate","prevProps","userID","render","length","splice","sort","a","b","uploadTimeA","Date","time","setMinutes","getMinutes","uploadTimeB","merchantCard","map","eachCard","index","discount","unit_price","price_floor","path","merchant_id","time_limit_min","name","routeArray","stripper"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport EachMerchant from './EachMerchant/EachMerchant'\nimport OrderHistory from '../OrderHistory/OrderHistory'\nimport { Route, Link, Redirect, Switch } from 'react-router-dom'\nimport IndivListing from '../IndivStore/IndivListing'\nimport ListingContainer from '../IndivStore/ListingContainer'\nexport default class TimeLine extends Component {\n    constructor(props) {\n        super()\n        this.state = {\n            timeLine: [],\n            cardUnmount: false\n        }\n    }\n    componentDidMount() {\n        fetch('/timeline')\n            .then(res => res.json())\n            .then(res => {\n                console.log(res)\n                this.setState({\n                    timeLine: res\n                })\n            })\n    }\n\n    componentDidUpdate(prevProps) {\n        console.log(this.props, this.state)\n        console.log('hi 1')\n        if (this.props.userID !== prevProps.userID) {\n            console.log('hi')\n            fetch('/timeline')\n                .then(res => res.json())\n                .then(res => {\n                    console.log(res)\n                    this.setState({\n                        timeLine: res\n                    })\n                })\n        }\n    }\n    merchantCardUnmountHandler = () => {\n        console.log('hi function')\n        fetch('/timeline')\n            .then(res => res.json())\n            .then(res => {\n                console.log(res)\n                this.setState({\n                    timeLine: res\n                })\n            })\n    }\n\n    render() {\n        if (this.state.timeLine.length > 20) {\n            this.state.timeLine.splice(19, this.state.timeLine.length - 20)\n        }\n\n        this.state.timeLine.sort(function (a, b) {\n            const uploadTimeA = new Date(a.time)\n            uploadTimeA.setMinutes(uploadTimeA.getMinutes() + a.time)\n            const uploadTimeB = new Date(b.time)\n            uploadTimeB.setMinutes(uploadTimeB.getMinutes() + b.time)\n            return uploadTimeA - uploadTimeB\n        })\n\n        const merchantCard = this.state.timeLine.map((eachCard, index) => {\n            const discount = (eachCard.unit_price - eachCard.price_floor) / eachCard.unit_price * 100\n            let path = \"/\" + eachCard.merchant_id\n            return <Link to={path}>\n\n                <EachMerchant key={index} duration={eachCard.time_limit_min} time={eachCard.time} merchant_Id={eachCard.merchant_id} unmount={this.merchantCardUnmountHandler}>\n                    <div>{eachCard.name}</div>\n                    <div>up to{discount}%</div>\n                </EachMerchant>\n\n            </Link>\n        })\n\n        const routeArray = this.state.timeLine.map((eachCard, index) => {\n            let path = \"/\" + eachCard.merchant_id\n            return <Route path={path} render={\n                () => <ListingContainer merchant_id={eachCard.merchant_id} stripper={this.props.stripper} />\n            } />\n        })\n        return (\n            <div>\n                <div className=\"navbar\">\n                    <div>Image here</div>\n                    <Link className=\"login break\" to=\"/Timeline\">Timeline</Link>\n                    <Link className=\"login break\" to=\"/Orderhistory\">Order history</Link>\n                </div>\n                <main>\n                    <Switch>\n                        {routeArray}\n                        <Route path=\"/Orderhistory\" render={\n                            () => <OrderHistory />\n                        } />\n                        <Route path=\"/\" render={\n                            () => <div>{merchantCard}</div>\n                        } />\n                    </Switch>\n                </main>\n            </div >\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}